{namespace v=FluidTYPO3\Vhs\ViewHelpers}
{namespace csn=Wind\Csnd\ViewHelpers}

<!-- not logged menu -->
<nav class="navbar {navBarClass}">
    <div class="{containerClass}">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">CSN</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <v:page.menu.directory entryLevel="1" levels="1" pages="{settings.root_page_uid}" as="menu" expandAll="true" class="nav navbar-nav" deferred="true">

                    <f:for each="{menu}" as="item" key="itemkey">
                      <v:page.menu.directory entryLevel="1" levels="1" pages="{item.uid}" as="subMenu" expandAll="true" deferred="true">
                            
                            <csn:ifUserLogged page="{item}">
                                <f:if condition="{subMenu->f:count()}>0">
                                    <f:then>
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{item.title}<span
                                                    class="caret"></span></a>
                                            <ul class="dropdown-menu">
                                                <f:for each="{subMenu}" as="subItem" key="subItemKey">
                                                    <li class="{subItem.class}">
                                                        <f:link.typolink parameter="{subItem.uid}">
                                                            {subItem.title}
                                                        </f:link.typolink>
                                                    </li>
                                                </f:for>
                                            </ul>
                                        </li>
                                    </f:then>
                                    <f:else>
                                        <li class="{item.class}">
                                            <f:link.typolink parameter="{item.uid}">
                                                {item.title}
                                            </f:link.typolink>
                                        </li>
                                    </f:else>
                                </f:if>
                            </csn:ifUserLogged>
                        </v:page.menu.directory>
                    </f:for>
                </v:page.menu.directory>
            </ul>
        </div>
    </div>
</nav>
<!-- /not logged menu -->