<div xmlns="http://www.w3.org/1999/xhtml" lang="en"
     xmlns:f="http://typo3.org/ns/TYPO3/Fluid/ViewHelpers"
     xmlns:flux="http://typo3.org/ns/FluidTYPO3/Flux/ViewHelpers"
     xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers">

    <f:layout name="Content"/>

    <f:section name="Configuration">
        <flux:form id="example" options="{group: 'FCE'}" label="User Status Ajax" description="Lista user status">

        </flux:form>
    </f:section>

    <f:section name="Preview">
        <strong>USER STATUS AJAX</strong><br/>

    </f:section>

    <f:section name="Main">
        <div class="status-info">
            <h2 class="title">
                Stato                
                <span id="status-label" 
                        class=" pull-right label {f:if(condition:'{user.online}',then:'label-success',else:'label-default')}">
                    <span   id="status-icon" 
                            class="glyphicon glyphicon-eye-{f:if(condition:'{user.online}',then:'open',else:'close')}"
                            aria-hidden="true">
                    </span>
                    <span 
                            id="status-text">{f:if(condition:'{user.online}',then:'online',else:'offline')}
                    </span>
                </span>              
            </h2>

            <button id="changeStatus" class="btn
                {f:if(condition:'{user.online}',then:'btn-default',else:'btn-success')}
                btn-xs btn-block">
                <f:if condition="{user.online}">
                    <f:then>
                        Passa offline <span class="glyphicon glyphicon-eye-close"
                                            aria-hidden="true"></span>
                    </f:then>
                    <f:else>
                        Passa online <span  class="glyphicon glyphicon-eye-open"
                                        aria-hidden="true"></span>
                    </f:else>
                </f:if>
            </button>
      </div>

        <script type="text/javascript">
            $( document ).ready(function() {
                
                var statoUser =  $("#status-icon");
               

                buttonAjax.click( ()=> {
           
                    $.post( "/rest/user/status/toggle", (response) => {
                        
                        if(response){
                            statoUser.addClass
                        }                       


                    }).fail((error) => {
                        //??
                    });
                })
            });
        </script>
    </f:section>
</div>
