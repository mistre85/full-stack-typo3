<div xmlns="http://www.w3.org/1999/xhtml" lang="en"
     xmlns:f="http://typo3.org/ns/TYPO3/Fluid/ViewHelpers"
     xmlns:flux="http://typo3.org/ns/FluidTYPO3/Flux/ViewHelpers"
     xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers">

    <f:layout name="Content"/>

    <f:section name="Configuration">  
        <flux:form id="ContactList" options="{group: 'Lista'}" label="Contact List"
        
        description="Contact List"></flux:form>
    </f:section>

    <f:section name="Preview">
        <strong>--Contact List</strong><br/>

    </f:section>

    <f:section name="Main">
        <v:page.header.link rel="stylesheet" href="/fileadmin/templates/css/PostList.css"/>
                   
            <div class="panel panel-default panelsize">
                <div class="panel-heading clearfix">
                    <div class="row">
                        <div class="col-lg-5">Contatti</div> 
                        <div class="col-lg-1 col-lg-offset-4">
                            <span class="glyphicon-class glyphicon glyphicon-facetime-video">                                  
                        </div>
                        <div class="col-lg-1">
                            <span class="glyphicon-class glyphicon glyphicon-search"></span>
                        </div>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="panel panel-default panelsize">
                        
                        <f:for each="{userList}" as="contactlist">
                            <f:render partial="contactListpartial" arguments="{item: contactlist}"></f:render>                        
                        </f:for>
                    </div>
                </div>
            </div>     
            
            
            
        <script type="text/javascript">
            $( document ).ready(function() {
                
                setInterval(function(){
                    
                    $.get( "/rest/user/status/updateListStatus", (response) => {                 
                                        
                        $.each(response.data, function( index, value ) {

                            
                            let uid = $('.chat-block .user-uid'+value.uid);
                            let userName = uid.find('.statoUtente');

                            if (value.online){
                                
                                userName.removeClass("fillbadgeOffLine").addClass("fillbadgeOnline");
                            }
                            else {
                                userName.removeClass("fillbadgeOnline").addClass("fillbadgeOffLine");
                            }
                            
                        });

                    }).fail((error) => {
                        //??
                    });

                 }, 3000);
                    
               
            });
        </script>

    </f:section>
</div>